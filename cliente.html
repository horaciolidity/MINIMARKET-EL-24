<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Cliente</title>
  <style>
    body { background: #000; color: #0f0; font-family: monospace; padding: 20px; }
    h1 { margin-bottom: 20px; }
    ul { list-style: none; padding: 0; }
    li { margin: 5px 0; }
  </style>
</head>
<body>
  <h1>Productos</h1>
  <ul id="lista"></ul>
  <h2>Total: $<span id="total">0.00</span></h2>

 <script>
  const canal = new BroadcastChannel('pos_channel');
  const lista = document.getElementById('lista');
  const total = document.getElementById('total');

  canal.onmessage = (e) => {
    const data = e.data;

    if (data.tipo === 'producto') {
      const { nombre, precio, cantidad, subtotal, totalActual } = data;
      const li = document.createElement('li');
      li.textContent = `${cantidad} x ${nombre} ($${precio.toFixed(2)}) = $${subtotal.toFixed(2)}`;
      lista.appendChild(li);
      total.textContent = totalActual.toFixed(2);
    }

    if (data.tipo === 'reset') {
      lista.innerHTML = '';
      total.textContent = '0.00';
    }
  };
</script>

</body>
</html>
